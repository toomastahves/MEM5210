# Required library
library(MASS)

# Initial variables
data3 <- data.frame(matrix(c(
  40.81, 72.97, 79.94, 88.01, 70.97, 31.06,1,
  38.91, 89.00, 79.59, 7.20, 66.84, 23.70,1,
  41.60, 88.17, 75.91, 10.73, 53.87, 29.05,1,
  60.65, 89.25, 77.41, 6.59, 74.92, 39.16,1,
  45.68, 97.26, 85.06, 9.23, 81.94, 45.01,1,
  79.66, 77.38, 67.48, 8.82, 71.99, 41.49,1,
  34.01, 93.47, 92.32, 9.38, 74.61, 18.99,2,
  22.04, 78.49, 83.27, 6.22, 52.60, 9.61,2,
  15.08, 66.17, 83.23, 1.56, 34.36, 6.70,2,
  19.95, 40.40, 59.04, 1.17, 31.94, 3.15,2,
  28.92, 63.62, 80.43, 5.06, 46.21, 9.07,2,
  22.59, 72.03, 84.54, 0.56, 45.93, 8.48,2,
  33.58, 41.85, 55.67, 22.80, 32.87, 12.94,3,
  45.63, 63.69, 62.36, 7.55, 44.23, 35.27,3,
  17.90, 34.35, 49.50, 3.20, 8.06, 7.24,3,
  31.68, 68.74, 78.11, 27.78, 49.13, 25.88,3,
  50.38, 50.57, 40.58, 40.21, 31.54, 29.16,3,
  54.42, 72.04, 69.33, 43.04, 33.90, 20.47,3
), ncol=7, byrow=TRUE))

# Train model
fit <- lda(X7 ~ X1 + X2 + X3 + X4 + X5 + X6, data = data3)
print(fit$scaling[,1])

# Assess accuracy
ct <- table(Actual = data3$X7, Predicted = predict(fit, data3)$class)
print(ct)

# Predict class
new <- data.frame(cbind(X1=44.48, X2=92.15, X3=77.19, X4=7.94, X5=40.35, X6=12.04))
classification_new <- predict(fit, new)
print(classification_new$posterior)